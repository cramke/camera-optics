<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/src/styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Camera Optics Calculator</title>
    <script type="module" src="/src/main.ts" defer></script>
  </head>

  <body>
    <div class="app-container">
      <header>
        <h1>ðŸ“· Camera Optics Calculator</h1>
        <p class="subtitle">Calculate FOV and spatial resolution for camera systems</p>
      </header>

      <div class="main-content">
        <!-- Left Panel: Camera Systems -->
        <div class="panel systems-panel">
          <h2>Camera Systems</h2>
          
          <div class="camera-form">
            <div class="form-group">
              <label for="name">Name (optional)</label>
              <input type="text" id="name" placeholder="e.g., Full Frame 50mm" />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="sensor-width">Sensor Width (mm)</label>
                <input type="number" id="sensor-width" value="36" step="0.1" />
              </div>
              <div class="form-group">
                <label for="sensor-height">Sensor Height (mm)</label>
                <input type="number" id="sensor-height" value="24" step="0.1" />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="pixel-width">Pixel Width</label>
                <input type="number" id="pixel-width" value="2000" step="1" />
              </div>
              <div class="form-group">
                <label for="pixel-height">Pixel Height</label>
                <input type="number" id="pixel-height" value="1500" step="1" />
              </div>
            </div>

            <div class="input-method-selector">
              <div class="input-method active" id="focal-method" data-method="focal">
                <div class="method-radio"></div>
                <div class="method-content">
                  <label class="method-label">Focal Length</label>
                  <div class="form-group">
                    <input type="number" id="focal-length" value="50" step="0.1" placeholder="mm" />
                  </div>
                </div>
              </div>

              <div class="input-method" id="fov-method" data-method="fov">
                <div class="method-radio"></div>
                <div class="method-content">
                  <label class="method-label">Field of View</label>
                  <div class="form-row">
                    <div class="form-group">
                      <label for="hfov-deg">Horizontal (Â°)</label>
                      <input type="number" id="hfov-deg" placeholder="e.g., 39.6" step="0.1" />
                    </div>
                    <div class="form-group">
                      <label for="vfov-deg">Vertical (Â°)</label>
                      <input type="number" id="vfov-deg" placeholder="e.g., 27" step="0.1" />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="distance">Working Distance (m)</label>
              <input type="number" id="distance" value="25" step="0.1" />
            </div>

            <div class="button-row">
              <button id="add-system-btn" class="secondary-btn full-width">Add to Comparison</button>
            </div>
          </div>

          <div class="presets">
            <h3>Quick Presets</h3>
            <button class="preset-btn" data-preset="full-frame">Full Frame</button>
            <button class="preset-btn" data-preset="aps-c">APS-C</button>
            <button class="preset-btn" data-preset="micro43">Micro 4/3</button>
          </div>

          <div id="systems-list" class="systems-list">
            <h3>Comparison List</h3>
            <div id="systems-items"></div>
          </div>
        </div>

        <!-- Right Panel: Visualization & Results -->
        <div class="panel results-panel">
          <div class="tabs">
            <button class="tab-btn active" data-tab="visualization">Visualization</button>
            <button class="tab-btn" data-tab="results">Results</button>
            <button class="tab-btn" data-tab="dori-designer">DORI Designer</button>
          </div>

          <div id="visualization-tab" class="tab-content active">
            <div class="canvas-container">
              <canvas id="fov-canvas" width="600" height="600"></canvas>
              <div id="canvas-legend" class="legend"></div>
            </div>
            <div class="reference-objects">
              <label for="ref-object-select">Reference Object:</label>
              <select id="ref-object-select">
                <!-- Options populated dynamically from TypeScript -->
              </select>
            </div>
          </div>

          <div id="results-tab" class="tab-content">
            <div id="results-output"></div>
          </div>

          <div id="dori-designer-tab" class="tab-content">
            <div class="dori-designer-content">
              <div class="designer-section">
                <h3>Target DORI Distances</h3>
                <p class="section-description">Specify your required surveillance distances</p>
                
                <div class="form-group">
                  <label for="target-detection">Detection Distance (m)</label>
                  <input type="number" id="target-detection" placeholder="e.g., 50" step="1" />
                  <span class="help-text">Identify that an object is present (25 px/m)</span>
                </div>
                
                <div class="form-group">
                  <label for="target-observation">Observation Distance (m)</label>
                  <input type="number" id="target-observation" placeholder="e.g., 20" step="1" />
                  <span class="help-text">Determine general characteristics (62.5 px/m)</span>
                </div>
                
                <div class="form-group">
                  <label for="target-recognition">Recognition Distance (m)</label>
                  <input type="number" id="target-recognition" placeholder="e.g., 10" step="1" />
                  <span class="help-text">Recognize familiar person/object (125 px/m)</span>
                </div>
                
                <div class="form-group">
                  <label for="target-identification">Identification Distance (m)</label>
                  <input type="number" id="target-identification" placeholder="e.g., 5" step="1" />
                  <span class="help-text">Identify specific person (250 px/m)</span>
                </div>
              </div>

              <div class="designer-section">
                <h3>Fixed Parameters</h3>
                <p class="section-description">Lock specific parameters to narrow down options</p>
                
                <div class="form-row">
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="fix-sensor-width" class="constraint-checkbox" />
                      Sensor Width (mm)
                    </label>
                    <input type="number" id="fixed-sensor-width" placeholder="e.g., 6.4" step="0.1" disabled />
                  </div>
                  
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="fix-pixel-width" class="constraint-checkbox" />
                      Pixel Width
                    </label>
                    <input type="number" id="fixed-pixel-width" placeholder="e.g., 1920" step="1" disabled />
                  </div>
                </div>
                
                <div class="form-row">
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="fix-focal-length" class="constraint-checkbox" />
                      Focal Length (mm)
                    </label>
                    <input type="number" id="fixed-focal-length" placeholder="e.g., 4" step="0.1" disabled />
                  </div>
                  
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="fix-sensor-height" class="constraint-checkbox" />
                      Sensor Height (mm)
                    </label>
                    <input type="number" id="fixed-sensor-height" placeholder="e.g., 4.8" step="0.1" disabled />
                  </div>
                </div>
              </div>

              <button id="calculate-ranges-btn" class="secondary-btn full-width">Calculate Parameter Ranges</button>

              <div id="parameter-ranges-output" class="designer-section" style="display: none;">
                <h3>Possible Parameter Ranges</h3>
                <div id="ranges-content"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast notification container -->
    <div id="toast-container"></div>
  </body>
</html>
